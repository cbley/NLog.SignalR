@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="container">
    <h1>NLog.SignalR - Demo</h1>

    <button class="btn btn-primary" id="createLogEntryButton">Create Log Entry</button>
    <hr />
    <div id="logs">
        <table id="logTable" class="table">
            <thead>
                <tr>
                    <th>Time</th>
                    <th>Level</th>
                    <th>Message</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

@section scripts {
    
    <script src="~/Scripts/jquery.signalR-2.1.1.min.js"></script>
    <script src="~/signalr/hubs"></script>

    <script>
        $(function() {
            $.ajaxSetup({ cache: false }); // prevent IE from caching ajax requests

            $("#createLogEntryButton").click(function() {
                $.getJSON('/Home/AddLogEntry', function() {});
            });

            var nlog = $.connection.loggingHub;

            nlog.client.log = function(logEvent) {
                $("#logTable tbody").prepend("<tr><td>" + logEvent.TimeStamp + "</td><td>" + logEvent.Level + "</td><td>" + logEvent.Message + "</td></tr>");
            };

            $.connection.hub.start().done(function() {
                $("#createLogEntryButton").focus();
            });
        })
    </script>
}
